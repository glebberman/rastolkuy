# Legal Translator - –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

**Legal Translator** - —ç—Ç–æ SaaS-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —è–∑—ã–∫. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–≥–æ–≤–æ—Ä—ã, –≤—ã–¥–µ–ª—è–µ—Ç —Ä–∏—Å–∫–∏ –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–Ω—è—Ç–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÑ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤**: PDF, DOCX, TXT
- ü§ñ **–ò–ò-–ø–µ—Ä–µ–≤–æ–¥**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Claude API (Sonnet/Haiku) –¥–ª—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- ‚ö†Ô∏è **–í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤
- üéØ **–°–∏—Å—Ç–µ–º–∞ —è–∫–æ—Ä–µ–π**: –¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ –∏ –ø–µ—Ä–µ–≤–æ–¥–∞
- üìä **–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**: –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üí≥ **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è**: Freemium –º–æ–¥–µ–ª—å —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

### –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

- **B2C**: –§–∏–∑–ª–∏—Ü–∞, –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—â–∏–µ –¥–æ–≥–æ–≤–æ—Ä—ã (—Ç—Ä—É–¥–æ–≤—ã–µ, –∏–ø–æ—Ç–µ—á–Ω—ã–µ, –∞—Ä–µ–Ω–¥—ã)
- **–§—Ä–∏–ª–∞–Ω—Å–µ—Ä—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –∑–∞–∫–∞–∑—á–∏–∫–∞–º–∏
- **–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å**: –ê–Ω–∞–ª–∏–∑ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –±–µ–∑ —à—Ç–∞—Ç–Ω–æ–≥–æ —é—Ä–∏—Å—Ç–∞
- **B2B**: –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã, –±–∞–Ω–∫–∏, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ (API/White-label)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

```
Backend: Laravel 11 + PHP 8.3
Database: PostgreSQL + Redis
AI: Claude API (Anthropic) - –≥–∏–±–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
Storage: MinIO (S3-compatible)
Queue: Redis
Testing: PHPUnit + Pest
Static Analysis: PHPStan Level 9 + Larastan
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. –°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```
app/Services/Parser/
‚îú‚îÄ‚îÄ ExtractorManager.php          # –§–∞–±—Ä–∏–∫–∞ —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ Extractors/
‚îÇ   ‚îú‚îÄ‚îÄ PdfExtractor.php         # –ü–∞—Ä—Å–∏–Ω–≥ PDF
‚îÇ   ‚îú‚îÄ‚îÄ DocxExtractor.php        # –ü–∞—Ä—Å–∏–Ω–≥ DOCX  
‚îÇ   ‚îú‚îÄ‚îÄ TxtExtractor.php         # –ü–∞—Ä—Å–∏–Ω–≥ TXT
‚îÇ   ‚îî‚îÄ‚îÄ Support/
‚îÇ       ‚îú‚îÄ‚îÄ ElementClassifier.php # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ EncodingDetector.php  # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
‚îÇ       ‚îî‚îÄ‚îÄ MetricsCollector.php  # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫
‚îî‚îÄ‚îÄ DTOs/
    ‚îî‚îÄ‚îÄ ExtractedDocument.php    # DTO –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```

#### 2. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```
app/Services/Structure/
‚îú‚îÄ‚îÄ StructureAnalyzer.php        # –ì–ª–∞–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ AnchorGenerator.php          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —è–∫–æ—Ä–µ–π
‚îú‚îÄ‚îÄ DTOs/
‚îÇ   ‚îî‚îÄ‚îÄ DocumentSection.php     # DTO —Å–µ–∫—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
‚îî‚îÄ‚îÄ Validation/
    ‚îî‚îÄ‚îÄ InputValidator.php       # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

#### 3. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –ò–ò
```
app/Services/Prompt/
‚îú‚îÄ‚îÄ ClaudeApiClient.php          # –ö–ª–∏–µ–Ω—Ç Claude API
‚îú‚îÄ‚îÄ TemplateEngine.php           # –î–≤–∏–∂–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –ø—Ä–æ–º–ø—Ç–æ–≤
‚îú‚îÄ‚îÄ QualityAnalyzer.php          # –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ SchemaManager.php            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JSON-—Å—Ö–µ–º–∞–º–∏
‚îú‚îÄ‚îÄ MetricsCollector.php         # –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
‚îî‚îÄ‚îÄ Exceptions/
    ‚îî‚îÄ‚îÄ PromptException.php      # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –ò–ò-—Å–∏—Å—Ç–µ–º—ã
```

#### 4. –°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```
app/Services/Validation/
‚îú‚îÄ‚îÄ DocumentValidator.php        # –ì–ª–∞–≤–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ Contracts/
‚îÇ   ‚îî‚îÄ‚îÄ ValidatorInterface.php   # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ Validators/
‚îÇ   ‚îú‚îÄ‚îÄ ContentValidator.php     # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
‚îÇ   ‚îú‚îÄ‚îÄ FileFormatValidator.php  # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ FileSizeValidator.php    # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ SecurityValidator.php    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ DTOs/
    ‚îî‚îÄ‚îÄ ValidationResult.php     # –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

## üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

#### PromptSystem
–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø—ã —à–∞–±–ª–æ–Ω–æ–≤.

```php
/**
 * @property int $id
 * @property string $name –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–º–ø—Ç–æ–≤
 * @property string $type –¢–∏–ø —Å–∏—Å—Ç–µ–º—ã (translation, analysis, generation)
 * @property string|null $system_prompt –ë–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
 * @property array<string, mixed>|null $schema JSON-—Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
 * @property bool $is_active –ê–∫—Ç–∏–≤–Ω–∞ –ª–∏ —Å–∏—Å—Ç–µ–º–∞
 */
```

#### PromptTemplate
–®–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.

```php
/**
 * @property int $id
 * @property string $template –¢–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ {{variable}}
 * @property array<int, string>|null $required_variables –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
 * @property array<int, string>|null $optional_variables –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
 * @property bool $is_active –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ —à–∞–±–ª–æ–Ω
 */
```

#### PromptExecution
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ - –∑–∞–ø–∏—Å—å –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ LLM.

```php
/**
 * @property string $rendered_prompt –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç
 * @property string|null $llm_response –û—Ç–≤–µ—Ç –æ—Ç —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏
 * @property 'pending'|'completed'|'failed' $status –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
 * @property array<string, mixed> $input_variables –í—Ö–æ–¥–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
 * @property float|null $execution_time_ms –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
 * @property int|null $tokens_used –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤
 * @property float|null $cost_usd –°—Ç–æ–∏–º–æ—Å—Ç—å –≤ USD
 */
```

#### PromptFeedback
–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤.

```php
/**
 * @property string $feedback_type –¢–∏–ø –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (quality, accuracy)
 * @property float|null $rating –ß–∏—Å–ª–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ (1-5 –∏–ª–∏ 0-1)
 * @property array<string, mixed>|null $details –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
 * @property string|null $user_type –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (human, system, automated)
 */
```

## üîß –ö–ª—é—á–µ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

### 1. –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —è–∫–æ—Ä—è–º–∏

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —è–∫–æ—Ä—è –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ü–∏–π –∏ –∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤:

```php
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —è–∫–æ—Ä—è –¥–ª—è —Å–µ–∫—Ü–∏–∏
private function generateAnchor(string $sectionId, string $title): string
{
    $cleanTitle = $this->transliterate($this->slugify($title));
    $hash = substr(md5($sectionId . $title), 0, 6);
    
    return "<!-- SECTION_ANCHOR_{$cleanTitle}_{$hash} -->";
}
```

### 2. –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤

```php
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
private function classifyElement(string $text): string
{
    $patterns = [
        'header' => ['/^\\d+\\.\\s+[–ê-–ØA-Z]/', '/^(–°—Ç–∞—Ç—å—è|–†–∞–∑–¥–µ–ª|–ì–ª–∞–≤–∞)/ui'],
        'list_item' => ['/^[\\-‚Ä¢]\\s+/', '/^\\d+\\)\\s+/'],
        'paragraph' => ['/^[–ê-–ØA-Z].*[.!?]$/u']
    ];
    
    foreach ($patterns as $type => $typePatterns) {
        foreach ($typePatterns as $pattern) {
            if (preg_match($pattern, trim($text))) {
                return $type;
            }
        }
    }
    
    return 'paragraph';
}
```

### 3. –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

```php
// –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–∞ Claude
public function analyzeQuality(string $response, array $context): array
{
    return [
        'completeness' => $this->checkCompleteness($response, $context),
        'accuracy' => $this->checkAccuracy($response, $context),
        'readability' => $this->calculateReadability($response),
        'risk_coverage' => $this->checkRiskCoverage($response),
        'overall_score' => $this->calculateOverallScore($metrics)
    ];
}
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤**: –õ–∏–º–∏—Ç 50MB
- **–í–∞–ª–∏–¥–∞—Ü–∏—è MIME-—Ç–∏–ø–æ–≤**: –¢–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞**: –ü–æ–∏—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **Rate limiting**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ IP –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è**: –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### API –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```php
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ regex —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç ReDoS
public static function safeRegexMatch(string $pattern, string $subject): array|false
{
    self::validateRegexPattern($pattern);
    
    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º PCRE limits
    ini_set('pcre.backtrack_limit', '100000');
    ini_set('pcre.recursion_limit', '100000');
    
    $result = @preg_match($pattern, $subject, $matches);
    
    if ($result === false || preg_last_error() !== PREG_NO_ERROR) {
        return false;
    }
    
    return $matches;
}
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Claude API

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ Redis
2. **–ë–∞—Ç—á–∏–Ω–≥**: –ú–µ–ª–∫–∏–µ —Å–µ–∫—Ü–∏–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏**: Haiku –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–µ–∫—Ü–∏–π, Sonnet –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö (—ç–∫–æ–Ω–æ–º–∏—è –¥–æ 90%)
4. **Retry –ª–æ–≥–∏–∫–∞**: –£–º–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```php
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏
public function processLargeDocument(UploadedFile $file): string
{
    $jobId = Str::uuid();
    
    // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —á–∞–Ω–∫–∏ –∏ —Å—Ç–∞–≤–∏–º –≤ –æ—á–µ—Ä–µ–¥—å
    ProcessDocumentJob::dispatch($file, $jobId)
        ->onQueue('document-processing')
        ->delay(now()->addSeconds(5));
        
    return $jobId;
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

- **Unit —Ç–µ—Å—Ç—ã**: 235+ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **Feature —Ç–µ—Å—Ç—ã**: –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **PHPStan Level 9**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **Continuous Integration**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ GitHub Actions

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

```php
public function testAnalyzesDocumentStructure(): void
{
    $document = $this->createTestDocument();
    $result = $this->analyzer->analyze($document);
    
    $this->assertGreaterThan(0, $result->getSectionsCount());
    $this->assertGreaterThan(0, $result->averageConfidence);
    $this->assertNotEmpty($result->sections);
}

public function testValidatesRegexSafety(): void
{
    $unsafePattern = '/(.*)+(.*)+/'; // ReDoS vulnerable
    
    $this->expectException(InvalidArgumentException::class);
    InputValidator::validateRegexPattern($unsafePattern);
}
```

## üí∞ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã

1. **Freemium**: 1 –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ 5 —Å—Ç—Ä–∞–Ω–∏—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ
2. **–†–∞–∑–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞**: –æ—Ç 199‚ÇΩ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
3. **Basic**: 990‚ÇΩ/–º–µ—Å—è—Ü - 20 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
4. **Pro**: 2990‚ÇΩ/–º–µ—Å—è—Ü - –±–µ–∑–ª–∏–º–∏—Ç + API (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏

```php
public function estimateCost(int $inputTokens, int $outputTokens, string $model): float
{
    // –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ 2025 –≥–æ–¥ (–∑–∞ 1M —Ç–æ–∫–µ–Ω–æ–≤)
    $pricing = [
        'claude-sonnet-4' => ['input' => 3.00, 'output' => 15.00],
        'claude-3-5-sonnet' => ['input' => 3.00, 'output' => 15.00], 
        'claude-3-5-haiku' => ['input' => 0.25, 'output' => 1.25],
    ];
    
    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å
    $rates = $pricing[$model] ?? $pricing['claude-sonnet-4'];
    $inputCost = ($inputTokens / 1000000) * $rates['input'];
    $outputCost = ($outputTokens / 1000000) * $rates['output'];
    
    return round($inputCost + $outputCost, 6);
}
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
version: '3.8'
services:
  app:
    build: ./docker/php
    volumes:
      - .:/var/www
    environment:
      - CLAUDE_API_KEY=${CLAUDE_API_KEY}
  
  nginx:
    build: ./docker/nginx
    ports:
      - "80:80"
    depends_on:
      - app
  
  postgres:
    image: postgres:16-alpine
    environment:
      - POSTGRES_DB=laravel
      - POSTGRES_USER=laravel
      - POSTGRES_PASSWORD=secret
  
  redis:
    image: redis:7.4-alpine
  
  minio:
    image: minio/minio
    ports:
      - "9000:9000"
    environment:
      - MINIO_ROOT_USER=minioadmin
      - MINIO_ROOT_PASSWORD=minioadmin

  # üöÄ Supervisor –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥—è–º–∏ Laravel
  supervisor:
    build:
      dockerfile: docker/supervisor/Dockerfile
    ports:
      - "9001:9001"  # Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Supervisor
    depends_on:
      - postgres
      - redis
    environment:
      - QUEUE_CONNECTION=redis
      - REDIS_HOST=redis
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Claude API
CLAUDE_API_KEY=your-claude-api-key
CLAUDE_MODEL=claude-sonnet-4  # –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –Ω–∞ claude-3-5-sonnet –∏–ª–∏ claude-3-5-haiku
CLAUDE_MAX_TOKENS=4096

# Database
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_DATABASE=legal_translator

# Storage
FILESYSTEM_DISK=minio
MINIO_ENDPOINT=http://minio:9000

# Queue & Supervisor
QUEUE_CONNECTION=redis
REDIS_HOST=redis

# –û—á–µ—Ä–µ–¥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏  
DOCUMENT_ANALYSIS_QUEUE=document-analysis
DOCUMENT_PROCESSING_QUEUE=document-processing
ANALYSIS_JOB_MAX_TRIES=3
ANALYSIS_JOB_TIMEOUT=300
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—è–º–∏

```bash
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./bin/queue-status.sh status    # –°—Ç–∞—Ç—É—Å worker'–æ–≤
./bin/queue-status.sh restart   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö worker'–æ–≤
./bin/queue-status.sh logs document-analysis  # –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞
./bin/queue-status.sh web       # Supervisor web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

# Laravel –∫–æ–º–∞–Ω–¥—ã
php artisan queue:monitor       # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π
php artisan queue:failed        # –ù–µ—É–¥–∞—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
php artisan queue:retry all     # –ü–æ–≤—Ç–æ—Ä –≤—Å–µ—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–¥–∞—á
```

## üìö –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞

- **PHPStan Level 9**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **Laravel 11**: –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞
- **PHP 8.3**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- **PSR-12**: –°—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è PHP

–í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ò–ò –∞–≥–µ–Ω—Ç–æ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ dev/agent-instruction.md

### DTO Guidelines

```php
// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π DTO
final readonly class DocumentProcessingRequest
{
    public function __construct(
        public string $filePath,
        public string $fileType,
        public array $options = []
    ) {}
    
    public static function fromRequest(ProcessDocumentRequest $request): self
    {
        return new self(
            filePath: $request->validated('file_path'),
            fileType: $request->validated('file_type'),
            options: $request->validated('options', [])
        );
    }
}
```

### API Endpoints

- **–†–æ—É—Ç—ã API**: `routes/api.php` —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ FormRequest –∫–ª–∞—Å—Å—ã
- **–û—Ç–≤–µ—Ç—ã**: –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ JsonResource
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ß–µ—Ä–µ–∑ Laravel Policies

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **Processing Time**: –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **API Usage**: –†–∞—Å—Ö–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤ Claude API  
- **Success Rate**: –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç–æ–∫
- **User Satisfaction**: NPS –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **Revenue**: MRR, ARPU, Churn Rate

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```php
Log::info('Document processing started', [
    'document_id' => $document->id,
    'file_size' => $document->size_bytes,
    'user_id' => $user->id,
    'processing_mode' => $mode
]);

Log::warning('High API costs detected', [
    'tokens_used' => $tokensUsed,
    'cost_usd' => $cost,
    'document_type' => $type
]);
```

## üîÑ CI/CD Pipeline

### GitHub Actions

```yaml
name: CI/CD
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.3'
          
      - name: Install dependencies
        run: composer install --prefer-dist --no-progress
        
      - name: PHPStan Analysis
        run: ./vendor/bin/phpstan analyse --level=9
        
      - name: Run Tests
        run: php artisan test --coverage
        
      - name: Security Check
        run: composer audit
```

## üéØ Roadmap

### –§–∞–∑–∞ 1 (MVP - 2 –Ω–µ–¥–µ–ª–∏)
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ PDF/DOCX
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Claude API
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —è–∫–æ—Ä–µ–π
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- [ ] –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –§–∞–∑–∞ 2 (–ú–µ—Å—è—Ü 1-2)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- [ ] API –¥–ª—è B2B –∫–ª–∏–µ–Ω—Ç–æ–≤  
- [ ] Telegram-–±–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –§–∞–∑–∞ 3 (–ú–µ—Å—è—Ü 3-6)
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏
- [ ] –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- [ ] White-label —Ä–µ—à–µ–Ω–∏—è
- [ ] –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **Product Owner**: –ì–ª–µ–± –ë–µ—Ä–º–∞–Ω
- **Backend**: Laravel 11 + Claude API
- **DevOps**: Docker + GitHub Actions
- **Testing**: PHPUnit + PHPStan Level 9

### –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã
- **–ü—Ä–æ–µ–∫—Ç**: [YouTrack RAS](https://glebberman.youtrack.cloud/projects/RAS) ‚Äì –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `YOUTRACK_API_TOKEN`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](https://glebberman.youtrack.cloud/projects/RAS/articles/RAS-A-2)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: [–ß–µ—Ä–Ω–æ–≤–∏–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](https://glebberman.youtrack.cloud/projects/RAS/articles/RAS-A-1)

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –Ø–Ω–≤–∞—Ä—å 2025*  
*–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã: MVP 1.0*
- –ú–Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ –∏–≤–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π LLM —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ —Ñ–µ–π–∫–æ–≤—É—é –≤—ã–¥–∞—á—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–ø–µ—Ä–µ–≤–æ–¥–∞) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ, —ç—Ç–æ —É–∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏–ª–∏ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å?